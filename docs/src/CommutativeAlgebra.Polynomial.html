<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE
    GeneralizedNewtypeDeriving
  , MultiParamTypeClasses
  , FlexibleInstances
  , DeriveFunctor
#-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- | En este m&#243;dulo se define el &#225;lgebra conmutativa de los polinomios sobre un cuerpo k.</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- </span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Los polinomios se representan como los vectores de un espacio vectorial cuya</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- base son los monomios. Por ejemplo, los polinomios en x,y,z son los vectores</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- del espacio vectorial de base </span><span>
</span><a name="line-13"></a><span class="hs-comment">-- {x^i y^j z^k | i &lt;- [0..], j &lt;- [0..], k &lt;- [0..] }.</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- </span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Puesto que los vectores del espacio vectorial tienen que estar ordenados, hay</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- que definir un orden entre los monomios.</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- </span><span>
</span><a name="line-18"></a><span class="hs-comment">-- Est&#225;n definidos los siguientes &#243;rdenes de los monomios:</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- * Lex: orden lexicogr&#225;fico. Por ejemplo,</span><span>
</span><a name="line-21"></a><span class="hs-comment">--   x^2+xy+xz+x+y^2+yz+y+z^2+z+1. </span><span>
</span><a name="line-22"></a><span class="hs-comment">-- * Glex: orden lexicogr&#225;fico graduado. Por ejemplo,</span><span>
</span><a name="line-23"></a><span class="hs-comment">--   x^2+xy+xz+y^2+yz+z^2+x+y+z+1.</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- * Grevlex: orden lexicogr&#225;fico graduado inverso. Por ejemplo,</span><span>
</span><a name="line-25"></a><span class="hs-comment">--   x^2+xy+y^2+xz+yz+z^2+x+y+z+1. </span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CommutativeAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">Polynomial</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span>             </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toSet</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span><span>   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">addmerge</span><span>
</span><a name="line-35"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">linear</span><span>
</span><a name="line-36"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nf</span><span>
</span><a name="line-37"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">terms</span><span>
</span><a name="line-38"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unwrap</span><span>
</span><a name="line-39"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>                                   </span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Structures</span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>                                   </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">CommutativeAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">Polynomial</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">P</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- |In order to work with monomials, we need to be able to multiply them and divide them.</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- Multiplication is defined by the Mon (monoid) class. Division is defined in this class.</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- The functions here are primarily intended for internal use only.</span><span>
</span><a name="line-49"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Monomial"><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier">Monomial</span></a></a><span> </span><a name="local-6989586621679068866"><a href="#local-6989586621679068866"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-identifier">mdivides</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-identifier">mdiv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier">mgcd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-identifier">mlcm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-identifier">mcoprime</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-identifier">mdeg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068866"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- mlcm m1 m2 = let m = mgcd m1 m2 in mmult m1 (mdiv m2 m)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><a name="mproperlydivides"><a href="CommutativeAlgebra.Polynomial.html#mproperlydivides"><span class="hs-identifier">mproperlydivides</span></a></a><span> </span><a name="local-6989586621679069491"><a href="#local-6989586621679069491"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679069492"><a href="#local-6989586621679069492"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679069491"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679069492"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier hs-var">mdivides</span></a><span> </span><a href="#local-6989586621679069491"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679069492"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- |We want to be able to construct monomials over any set of variables that we choose.</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- Although we will often use String as the type of our variables,</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- it is useful to define polymorphic types for monomials.</span><span>
</span><a name="line-65"></a><span class="hs-keyword">class</span><span> </span><a name="MonomialConstructor"><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier">MonomialConstructor</span></a></a><span> </span><a name="local-6989586621679068863"><a href="#local-6989586621679068863"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-identifier">mvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068864"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068863"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679068864"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-identifier">mindices</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679068863"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679068865"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679068865"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | (var v) es una variable del espacio vectorial de los polinomios. Por</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- ejemplo, para trabajar en Q[x,y,z] con el orden lexicogr&#225;fico</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- graduado, se definen las siguientes variables</span><span>
</span><a name="line-72"></a><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- &gt;&gt;&gt; let [x,y,z] = map var [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;] :: [LexPoly Q String]</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- &gt;&gt;&gt; (x+y^2+z^4)^3</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- x^3+3x^2y^2+3x^2z^4+3xy^4+6xy^2z^4+3xz^8+y^6+3y^4z^4+3y^2z^8+z^12</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- &gt;&gt;&gt; let [x,y,z] = map var [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;] :: [GlexPoly Q String]</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- &gt;&gt;&gt; (x+y^2+z^4)^3</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- z^12+3y^2z^8+3xz^8+3y^4z^4+6xy^2z^4+3x^2z^4+y^6+3xy^4+3x^2y^2+x^3</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- &gt;&gt;&gt; let [x,y,z] = map var [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;] :: [GrevlexPoly Q String]</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- &gt;&gt;&gt; (x+y^2+z^4)^3</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- z^12+3y^2z^8+3xz^8+3y^4z^4+6xy^2z^4+y^6+3x^2z^4+3xy^4+3x^2y^2+x^3</span><span>
</span><a name="line-82"></a><span class="hs-identifier">var</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679069488"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="#local-6989586621679069489"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679069490"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069488"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069489"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069490"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><a name="var"><a href="CommutativeAlgebra.Polynomial.html#var"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mvar"><span class="hs-identifier hs-var">mvar</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- class MonomialOrder m where</span><span>
</span><a name="line-86"></a><span class="hs-comment">--     isGraded :: m -&gt; Bool</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- MONOMIALS</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- |The underlying implementation of monomials in variables of type v. Most often, we will be interested in MonImpl String,</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- with the variable \&quot;x\&quot; represented by M 1 [(\&quot;x\&quot;,1)]. However, other types can be used instead.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- No Ord instance is defined for MonImpl v, so it cannot be used as the basis for a free vector space of polynomials.</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- Instead, several different newtype wrappers are provided, corresponding to different monomial orderings.</span><span>
</span><a name="line-96"></a><span class="hs-keyword">data</span><span> </span><a name="MonImpl"><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier">MonImpl</span></a></a><span> </span><a name="local-6989586621679068862"><a href="#local-6989586621679068862"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="M"><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier">M</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679068862"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- The initial Int is the degree of the monomial. Storing it speeds up equality tests and comparisons</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679071044"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679071044"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-100"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679071045"><a href="#local-6989586621679071045"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679071048"><a href="#local-6989586621679071048"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071049"><a href="#local-6989586621679071049"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679071049"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679071046"><span class="hs-identifier hs-var">showVar</span></a><span> </span><a href="#local-6989586621679071048"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679071046"><span class="hs-identifier hs-var">showVar</span></a><span> </span><a href="#local-6989586621679071048"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;^&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679071049"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071045"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-102"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679071046"><a href="#local-6989586621679071046"><span class="hs-identifier">showVar</span></a></a><span> </span><a name="local-6989586621679071047"><a href="#local-6989586621679071047"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">'&quot;'</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679071047"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- in case v == String</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679071039"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679071039"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-8214565720323838683"><span class="hs-identifier">munit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-8214565720323838684"><span class="hs-identifier">mmult</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679071040"><a href="#local-6989586621679071040"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679071041"><a href="#local-6989586621679071041"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679071042"><a href="#local-6989586621679071042"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679071043"><a href="#local-6989586621679071043"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679071040"><span class="hs-identifier hs-var">si</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071042"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">addmerge</span><span> </span><a href="#local-6989586621679071041"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679071043"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070977"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070977"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679070977"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-8214565720323839623"><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier">mdivides</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070978"><a href="#local-6989586621679070978"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070979"><a href="#local-6989586621679070979"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070980"><a href="#local-6989586621679070980"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679070981"><a href="#local-6989586621679070981"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070978"><span class="hs-identifier hs-var">si</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679070980"><span class="hs-identifier hs-var">sj</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679070982"><span class="hs-identifier hs-var">mdivides'</span></a><span> </span><a href="#local-6989586621679070979"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679070981"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-110"></a><span>        </span><a name="local-6989586621679070982"><a href="#local-6989586621679070982"><span class="hs-identifier">mdivides'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679070983"><a href="#local-6989586621679070983"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070984"><a href="#local-6989586621679070984"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679070985"><a href="#local-6989586621679070985"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679070986"><a href="#local-6989586621679070986"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070987"><a href="#local-6989586621679070987"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679070988"><a href="#local-6989586621679070988"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-111"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679070983"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679070986"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-112"></a><span>            </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-113"></a><span>            </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070982"><span class="hs-identifier hs-var">mdivides'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679070983"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679070984"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679070985"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070988"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-114"></a><span>            </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679070984"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&lt;=</span><a href="#local-6989586621679070987"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679070982"><span class="hs-identifier hs-var">mdivides'</span></a><span> </span><a href="#local-6989586621679070985"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679070988"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-115"></a><span>        </span><span class="hs-identifier">mdivides'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-116"></a><span>        </span><span class="hs-identifier">mdivides'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-8214565720323839624"><a href="CommutativeAlgebra.Polynomial.html#mdiv"><span class="hs-identifier">mdiv</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070989"><a href="#local-6989586621679070989"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070990"><a href="#local-6989586621679070990"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070991"><a href="#local-6989586621679070991"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679070992"><a href="#local-6989586621679070992"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070989"><span class="hs-identifier hs-var">si</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679070991"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">addmerge</span><span> </span><a href="#local-6989586621679070990"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679070993"><a href="#local-6989586621679070993"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070994"><a href="#local-6989586621679070994"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070993"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679070994"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070992"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-comment">-- we don't check that the result has no negative indices</span><span>
</span><a name="line-119"></a><span>    </span><a name="local-8214565720323839625"><a href="CommutativeAlgebra.Polynomial.html#mgcd"><span class="hs-identifier">mgcd</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679070995"><a href="#local-6989586621679070995"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679070996"><a href="#local-6989586621679070996"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070997"><span class="hs-identifier hs-var">mgcd'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679070995"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679070996"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-120"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679070997"><a href="#local-6989586621679070997"><span class="hs-identifier">mgcd'</span></a></a><span> </span><a name="local-6989586621679070998"><a href="#local-6989586621679070998"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679070999"><a href="#local-6989586621679070999"><span class="hs-identifier">zks</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071000"><a href="#local-6989586621679071000"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071001"><a href="#local-6989586621679071001"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071002"><a href="#local-6989586621679071002"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071003"><a href="#local-6989586621679071003"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071004"><a href="#local-6989586621679071004"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071005"><a href="#local-6989586621679071005"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-121"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679071000"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679071003"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-122"></a><span>                  </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070997"><span class="hs-identifier hs-var">mgcd'</span></a><span> </span><a href="#local-6989586621679070998"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679070999"><span class="hs-identifier hs-var">zks</span></a><span> </span><a href="#local-6989586621679071002"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071003"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679071004"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071005"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>                  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070997"><span class="hs-identifier hs-var">mgcd'</span></a><span> </span><a href="#local-6989586621679070998"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679070999"><span class="hs-identifier hs-var">zks</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071000"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071001"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071002"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071005"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-124"></a><span>                  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679071006"><a href="#local-6989586621679071006"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679071001"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679071004"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679070997"><span class="hs-identifier hs-var">mgcd'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070998"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071006"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071000"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071006"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679070999"><span class="hs-identifier hs-var">zks</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071002"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679071005"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-125"></a><span>              </span><span class="hs-identifier">mgcd'</span><span> </span><a name="local-6989586621679071007"><a href="#local-6989586621679071007"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679071008"><a href="#local-6989586621679071008"><span class="hs-identifier">zks</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a href="#local-6989586621679071007"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679071008"><span class="hs-identifier hs-var">zks</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><a name="local-8214565720323839626"><a href="CommutativeAlgebra.Polynomial.html#mlcm"><span class="hs-identifier">mlcm</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679071009"><a href="#local-6989586621679071009"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679071010"><a href="#local-6989586621679071010"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679071011"><a href="#local-6989586621679071011"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679071012"><a href="#local-6989586621679071012"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679071013"><span class="hs-identifier hs-var">mlcm'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679071010"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679071012"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-127"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679071013"><a href="#local-6989586621679071013"><span class="hs-identifier">mlcm'</span></a></a><span> </span><a name="local-6989586621679071014"><a href="#local-6989586621679071014"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679071015"><a href="#local-6989586621679071015"><span class="hs-identifier">zks</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071016"><a href="#local-6989586621679071016"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071017"><a href="#local-6989586621679071017"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071018"><a href="#local-6989586621679071018"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071019"><a href="#local-6989586621679071019"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071020"><a href="#local-6989586621679071020"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071021"><a href="#local-6989586621679071021"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679071019"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-129"></a><span>                  </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679071013"><span class="hs-identifier hs-var">mlcm'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679071014"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071015"><span class="hs-identifier hs-var">zks</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071018"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071019"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071021"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>                  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679071013"><span class="hs-identifier hs-var">mlcm'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679071014"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071019"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071015"><span class="hs-identifier hs-var">zks</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071018"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071021"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-131"></a><span>                  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679071022"><a href="#local-6989586621679071022"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679071013"><span class="hs-identifier hs-var">mlcm'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679071014"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071015"><span class="hs-identifier hs-var">zks</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071018"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679071021"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-132"></a><span>              </span><span class="hs-identifier">mlcm'</span><span> </span><a name="local-6989586621679071023"><a href="#local-6989586621679071023"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679071024"><a href="#local-6989586621679071024"><span class="hs-identifier">zks</span></a></a><span> </span><a name="local-6989586621679071025"><a href="#local-6989586621679071025"><span class="hs-identifier">xis</span></a></a><span> </span><a name="local-6989586621679071026"><a href="#local-6989586621679071026"><span class="hs-identifier">yjs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679071027"><a href="#local-6989586621679071027"><span class="hs-identifier">zks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679071025"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679071026"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679071028"><a href="#local-6989586621679071028"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679071027"><span class="hs-identifier hs-var">zks'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- either xis or yjs is null</span><span>
</span><a name="line-133"></a><span>                                    </span><span class="hs-keyword">in</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679071023"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679071028"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679071024"><span class="hs-identifier hs-var">zks</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679071027"><span class="hs-identifier hs-var">zks'</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>    </span><a name="local-8214565720323839627"><a href="CommutativeAlgebra.Polynomial.html#mcoprime"><span class="hs-identifier">mcoprime</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679071029"><a href="#local-6989586621679071029"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679071030"><a href="#local-6989586621679071030"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679071031"><span class="hs-identifier hs-var">mcoprime'</span></a><span> </span><a href="#local-6989586621679071029"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679071030"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-135"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679071031"><a href="#local-6989586621679071031"><span class="hs-identifier">mcoprime'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071032"><a href="#local-6989586621679071032"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071033"><a href="#local-6989586621679071033"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071034"><a href="#local-6989586621679071034"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679071035"><a href="#local-6989586621679071035"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679071036"><a href="#local-6989586621679071036"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679071037"><a href="#local-6989586621679071037"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-136"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679071032"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679071035"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-137"></a><span>                  </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679071031"><span class="hs-identifier hs-var">mcoprime'</span></a><span> </span><a href="#local-6989586621679071034"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071035"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679071036"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071037"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>                  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679071031"><span class="hs-identifier hs-var">mcoprime'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679071032"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679071033"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679071034"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679071037"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-139"></a><span>                  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-140"></a><span>              </span><span class="hs-identifier">mcoprime'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-comment">-- mcoprime m1 m2 = mgcd m1 m2 == munit</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-8214565720323839628"><a href="CommutativeAlgebra.Polynomial.html#mdeg"><span class="hs-identifier">mdeg</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679071038"><a href="#local-6989586621679071038"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679071038"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-8214565720323839620"><a href="CommutativeAlgebra.Polynomial.html#mvar"><span class="hs-identifier">mvar</span></a></a><span> </span><a name="local-6989586621679070974"><a href="#local-6989586621679070974"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679070974"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><span>    </span><a name="local-8214565720323839621"><a href="CommutativeAlgebra.Polynomial.html#mindices"><span class="hs-identifier">mindices</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070975"><a href="#local-6989586621679070975"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070976"><a href="#local-6989586621679070976"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070976"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- LEX ORDER</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-comment">-- |A type representing monomials with Lex ordering.</span><span>
</span><a name="line-152"></a><span class="hs-comment">--</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- Lex stands for lexicographic ordering.</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- For example, in Lex ordering, monomials up to degree two would be ordered as follows: x^2+xy+xz+x+y^2+yz+y+z^2+z+1.</span><span>
</span><a name="line-155"></a><span class="hs-keyword">newtype</span><span> </span><a name="Lex"><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier">Lex</span></a></a><span> </span><a name="local-6989586621679068861"><a href="#local-6989586621679068861"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lex"><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier">Lex</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679068861"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- GeneralizedNewtypeDeriving</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070972"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-type">Lex</span></a><span> </span><a href="#local-6989586621679070972"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-var">Lex</span></a><span> </span><a name="local-6989586621679070973"><a href="#local-6989586621679070973"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070973"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070960"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-type">Lex</span></a><span> </span><a href="#local-6989586621679070960"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>    </span><a name="local-8214565720323790861"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-var">Lex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070961"><a href="#local-6989586621679070961"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070962"><a href="#local-6989586621679070962"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-var">Lex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070963"><a href="#local-6989586621679070963"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679070964"><a href="#local-6989586621679070964"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070965"><span class="hs-identifier hs-var">compare'</span></a><span> </span><a href="#local-6989586621679070962"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679070964"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-162"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679070965"><a href="#local-6989586621679070965"><span class="hs-identifier">compare'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679070966"><a href="#local-6989586621679070966"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070967"><a href="#local-6989586621679070967"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679070968"><a href="#local-6989586621679070968"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679070969"><a href="#local-6989586621679070969"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070970"><a href="#local-6989586621679070970"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679070971"><a href="#local-6989586621679070971"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-163"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679070966"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679070969"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-164"></a><span>                  </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-165"></a><span>                  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-166"></a><span>                  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679070967"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679070970"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-167"></a><span>                        </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-168"></a><span>                        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-169"></a><span>                        </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070965"><span class="hs-identifier hs-var">compare'</span></a><span> </span><a href="#local-6989586621679070968"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679070971"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-170"></a><span>              </span><span class="hs-identifier">compare'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-171"></a><span>              </span><span class="hs-identifier">compare'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-172"></a><span>              </span><span class="hs-identifier">compare'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-173"></a><span>        </span><span class="hs-comment">-- unfortunately we can't use the following, because we want [] sorted after everything, not before</span><span>
</span><a name="line-174"></a><span>        </span><span class="hs-comment">-- compare [(x,-i) | (x,i) &lt;- xis] [(y,-j) | (y,j) &lt;- yjs]</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- instance MonomialOrder Lex where isGraded _ = False</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- |A type representing polynomials with Lex term ordering.</span><span>
</span><a name="line-179"></a><span class="hs-keyword">type</span><span> </span><a name="LexPoly"><a href="CommutativeAlgebra.Polynomial.html#LexPoly"><span class="hs-identifier">LexPoly</span></a></a><span> </span><a name="local-6989586621679068859"><a href="#local-6989586621679068859"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679068860"><a href="#local-6989586621679068860"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068859"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-type">Lex</span></a><span> </span><a href="#local-6989586621679068860"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- |@lexvar v@ creates a variable in the algebra of commutative polynomials over Q with Lex term ordering.</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- It is provided as a shortcut, to avoid having to provide a type annotation, as with @var@.</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- For example, the following code creates variables called x, y and z:</span><span>
</span><a name="line-184"></a><span class="hs-comment">--</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- &gt; [x,y,z] = map lexvar [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]</span><span>
</span><a name="line-186"></a><span class="hs-identifier">lexvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679069487"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#LexPoly"><span class="hs-identifier hs-type">LexPoly</span></a><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679069487"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-187"></a><a name="lexvar"><a href="CommutativeAlgebra.Polynomial.html#lexvar"><span class="hs-identifier">lexvar</span></a></a><span> </span><a name="local-6989586621679069493"><a href="#local-6989586621679069493"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-var">Lex</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679069493"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- lexvar = var</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679070954"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679070954"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070955"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070955"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679070954"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Lex"><span class="hs-identifier hs-type">Lex</span></a><span> </span><a href="#local-6989586621679070955"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-191"></a><span>    </span><a name="local-8214565720323838698"><span class="hs-identifier">unit</span></a><span> </span><a name="local-6989586621679070956"><a href="#local-6989586621679070956"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070956"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">munit</span><span>
</span><a name="line-192"></a><span>    </span><a name="local-8214565720323838699"><span class="hs-identifier">mult</span></a><span> </span><a name="local-6989586621679070957"><a href="#local-6989586621679070957"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679070958"><a href="#local-6989586621679070958"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070959"><a href="#local-6989586621679070959"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070958"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mmult</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070959"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070957"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- GLEX ORDER</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- |A type representing monomials with Glex ordering.</span><span>
</span><a name="line-198"></a><span class="hs-comment">--</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- Glex stands for graded lexicographic. Thus monomials are ordered first by degree, then by lexicographic order.</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- For example, in Glex ordering, monomials up to degree two would be ordered as follows: x^2+xy+xz+y^2+yz+z^2+x+y+z+1.</span><span>
</span><a name="line-201"></a><span class="hs-keyword">newtype</span><span> </span><a name="Glex"><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier">Glex</span></a></a><span> </span><a name="local-6989586621679068858"><a href="#local-6989586621679068858"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Glex"><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier">Glex</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679068858"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- GeneralizedNewtypeDeriving</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070952"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-type">Glex</span></a><span> </span><a href="#local-6989586621679070952"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679070953"><a href="#local-6989586621679070953"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070953"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070943"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-type">Glex</span></a><span> </span><a href="#local-6989586621679070943"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-207"></a><span>    </span><a name="local-8214565720323790861"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070944"><a href="#local-6989586621679070944"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070945"><a href="#local-6989586621679070945"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070946"><a href="#local-6989586621679070946"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679070947"><a href="#local-6989586621679070947"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679070944"><span class="hs-identifier hs-var">si</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679070948"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679070949"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070948"><a href="#local-6989586621679070948"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070949"><a href="#local-6989586621679070949"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679070945"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679070946"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679070950"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679070951"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070950"><a href="#local-6989586621679070950"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070951"><a href="#local-6989586621679070951"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679070947"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">-- instance MonomialOrder Glex where isGraded _ = True</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- |A type representing polynomials with Glex term ordering.</span><span>
</span><a name="line-213"></a><span class="hs-keyword">type</span><span> </span><a name="GlexPoly"><a href="CommutativeAlgebra.Polynomial.html#GlexPoly"><span class="hs-identifier">GlexPoly</span></a></a><span> </span><a name="local-6989586621679068856"><a href="#local-6989586621679068856"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679068857"><a href="#local-6989586621679068857"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068856"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-type">Glex</span></a><span> </span><a href="#local-6989586621679068857"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- |@glexvar v@ creates a variable in the algebra of commutative polynomials over Q with Glex term ordering.</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- It is provided as a shortcut, to avoid having to provide a type annotation, as with @var@.</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- For example, the following code creates variables called x, y and z:</span><span>
</span><a name="line-218"></a><span class="hs-comment">--</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- &gt; [x,y,z] = map glexvar [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]</span><span>
</span><a name="line-220"></a><span class="hs-identifier">glexvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679069486"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#GlexPoly"><span class="hs-identifier hs-type">GlexPoly</span></a><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679069486"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-221"></a><a name="glexvar"><a href="CommutativeAlgebra.Polynomial.html#glexvar"><span class="hs-identifier">glexvar</span></a></a><span> </span><a name="local-6989586621679069494"><a href="#local-6989586621679069494"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679069494"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- glexvar = var</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679070937"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679070937"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070938"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070938"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679070937"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Glex"><span class="hs-identifier hs-type">Glex</span></a><span> </span><a href="#local-6989586621679070938"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-225"></a><span>    </span><a name="local-8214565720323838698"><span class="hs-identifier">unit</span></a><span> </span><a name="local-6989586621679070939"><a href="#local-6989586621679070939"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070939"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">munit</span><span>
</span><a name="line-226"></a><span>    </span><a name="local-8214565720323838699"><span class="hs-identifier">mult</span></a><span> </span><a name="local-6989586621679070940"><a href="#local-6989586621679070940"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679070941"><a href="#local-6989586621679070941"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070942"><a href="#local-6989586621679070942"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070941"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mmult</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070942"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070940"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- GREVLEX ORDER</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- |A type representing monomials with Grevlex ordering.</span><span>
</span><a name="line-232"></a><span class="hs-comment">--</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- Grevlex stands for graded reverse lexicographic. Thus monomials are ordered first by degree, then by reverse lexicographic order.</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- For example, in Grevlex ordering, monomials up to degree two would be ordered as follows: x^2+xy+y^2+xz+yz+z^2+x+y+z+1.</span><span>
</span><a name="line-235"></a><span class="hs-comment">--</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- In general, Grevlex leads to the smallest Groebner bases.</span><span>
</span><a name="line-237"></a><span class="hs-keyword">newtype</span><span> </span><a name="Grevlex"><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier">Grevlex</span></a></a><span> </span><a name="local-6989586621679068855"><a href="#local-6989586621679068855"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Grevlex"><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier">Grevlex</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#MonImpl"><span class="hs-identifier hs-type">MonImpl</span></a><span> </span><a href="#local-6989586621679068855"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- GeneralizedNewtypeDeriving</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070935"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-type">Grevlex</span></a><span> </span><a href="#local-6989586621679070935"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-240"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-var">Grevlex</span></a><span> </span><a name="local-6989586621679070936"><a href="#local-6989586621679070936"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070936"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070930"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-type">Grevlex</span></a><span> </span><a href="#local-6989586621679070930"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-243"></a><span>    </span><a name="local-8214565720323790861"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-var">Grevlex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070931"><a href="#local-6989586621679070931"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679070932"><a href="#local-6989586621679070932"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-var">Grevlex</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><a name="local-6989586621679070933"><a href="#local-6989586621679070933"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679070934"><a href="#local-6989586621679070934"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-244"></a><span>        </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679070931"><span class="hs-identifier hs-var">si</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679070932"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679070933"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679070934"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">-- instance MonomialOrder Grevlex where isGraded _ = True</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">-- |A type representing polynomials with Grevlex term ordering.</span><span>
</span><a name="line-249"></a><span class="hs-keyword">type</span><span> </span><a name="GrevlexPoly"><a href="CommutativeAlgebra.Polynomial.html#GrevlexPoly"><span class="hs-identifier">GrevlexPoly</span></a></a><span> </span><a name="local-6989586621679068853"><a href="#local-6989586621679068853"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679068854"><a href="#local-6989586621679068854"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068853"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-type">Grevlex</span></a><span> </span><a href="#local-6989586621679068854"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- |@grevlexvar v@ creates a variable in the algebra of commutative polynomials over Q with Grevlex term ordering.</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- It is provided as a shortcut, to avoid having to provide a type annotation, as with @var@.</span><span>
</span><a name="line-253"></a><span class="hs-comment">-- For example, the following code creates variables called x, y and z:</span><span>
</span><a name="line-254"></a><span class="hs-comment">--</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- &gt; [x,y,z] = map grevlexvar [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]</span><span>
</span><a name="line-256"></a><span class="hs-identifier">grevlexvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679069485"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#GrevlexPoly"><span class="hs-identifier hs-type">GrevlexPoly</span></a><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679069485"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-257"></a><a name="grevlexvar"><a href="CommutativeAlgebra.Polynomial.html#grevlexvar"><span class="hs-identifier">grevlexvar</span></a></a><span> </span><a name="local-6989586621679069495"><a href="#local-6989586621679069495"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-var">Grevlex</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679069495"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- grevlexvar = var</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679070924"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679070924"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679070924"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Grevlex"><span class="hs-identifier hs-type">Grevlex</span></a><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-261"></a><span>    </span><a name="local-8214565720323838698"><span class="hs-identifier">unit</span></a><span> </span><a name="local-6989586621679070926"><a href="#local-6989586621679070926"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070926"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">munit</span><span>
</span><a name="line-262"></a><span>    </span><a name="local-8214565720323838699"><span class="hs-identifier">mult</span></a><span> </span><a name="local-6989586621679070927"><a href="#local-6989586621679070927"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679070928"><a href="#local-6989586621679070928"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070929"><a href="#local-6989586621679070929"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070928"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mmult</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070929"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070927"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- ELIMINATION ORDER</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-keyword">data</span><span> </span><a name="Elim2"><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier">Elim2</span></a></a><span> </span><a name="local-6989586621679068851"><a href="#local-6989586621679068851"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679068852"><a href="#local-6989586621679068852"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Elim2"><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier">Elim2</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679068851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679068852"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-type">Elim2</span></a><span> </span><a href="#local-6989586621679070918"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-270"></a><span>    </span><a name="local-8214565720323790861"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070920"><a href="#local-6989586621679070920"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070921"><a href="#local-6989586621679070921"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070922"><a href="#local-6989586621679070922"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070923"><a href="#local-6989586621679070923"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070920"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><a href="#local-6989586621679070921"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070922"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">,</span><a href="#local-6989586621679070923"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070910"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-type">Elim2</span></a><span> </span><a href="#local-6989586621679070910"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-273"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070912"><a href="#local-6989586621679070912"><span class="hs-identifier">ma</span></a></a><span> </span><a name="local-6989586621679070913"><a href="#local-6989586621679070913"><span class="hs-identifier">mb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070912"><span class="hs-identifier hs-var">ma</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070913"><span class="hs-identifier hs-var">mb</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-274"></a><span>                       </span><span class="hs-special">(</span><span class="hs-string">&quot;1&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-275"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679070914"><a href="#local-6989586621679070914"><span class="hs-identifier">ma'</span></a></a><span class="hs-special">,</span><span class="hs-string">&quot;1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070914"><span class="hs-identifier hs-var">ma'</span></a><span>
</span><a name="line-276"></a><span>                       </span><span class="hs-special">(</span><span class="hs-string">&quot;1&quot;</span><span class="hs-special">,</span><a name="local-6989586621679070915"><a href="#local-6989586621679070915"><span class="hs-identifier">mb'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070915"><span class="hs-identifier hs-var">mb'</span></a><span>
</span><a name="line-277"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679070916"><a href="#local-6989586621679070916"><span class="hs-identifier">ma'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070917"><a href="#local-6989586621679070917"><span class="hs-identifier">mb'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070916"><span class="hs-identifier hs-var">ma'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679070917"><span class="hs-identifier hs-var">mb'</span></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Mon</span><span> </span><a href="#local-6989586621679070904"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><a href="#local-6989586621679070905"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-type">Elim2</span></a><span> </span><a href="#local-6989586621679070904"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070905"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-280"></a><span>    </span><a name="local-8214565720323838683"><span class="hs-identifier">munit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><span class="hs-identifier hs-var">munit</span><span> </span><span class="hs-identifier hs-var">munit</span><span>
</span><a name="line-281"></a><span>    </span><a name="local-8214565720323838684"><span class="hs-identifier">mmult</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070906"><a href="#local-6989586621679070906"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070907"><a href="#local-6989586621679070907"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070908"><a href="#local-6989586621679070908"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070909"><a href="#local-6989586621679070909"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mmult</span><span> </span><a href="#local-6989586621679070906"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070908"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mmult</span><span> </span><a href="#local-6989586621679070907"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070909"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><a href="#local-6989586621679070880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><a href="#local-6989586621679070881"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-type">Elim2</span></a><span> </span><a href="#local-6989586621679070880"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070881"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-284"></a><span>    </span><a name="local-8214565720323839623"><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier">mdivides</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070882"><a href="#local-6989586621679070882"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070883"><a href="#local-6989586621679070883"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070884"><a href="#local-6989586621679070884"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070885"><a href="#local-6989586621679070885"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier hs-var">mdivides</span></a><span> </span><a href="#local-6989586621679070882"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070884"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier hs-var">mdivides</span></a><span> </span><a href="#local-6989586621679070883"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070885"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-285"></a><span>    </span><a name="local-8214565720323839624"><a href="CommutativeAlgebra.Polynomial.html#mdiv"><span class="hs-identifier">mdiv</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070886"><a href="#local-6989586621679070886"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070887"><a href="#local-6989586621679070887"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070888"><a href="#local-6989586621679070888"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070889"><a href="#local-6989586621679070889"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mdiv"><span class="hs-identifier hs-var">mdiv</span></a><span> </span><a href="#local-6989586621679070886"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070888"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mdiv"><span class="hs-identifier hs-var">mdiv</span></a><span> </span><a href="#local-6989586621679070887"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070889"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>    </span><a name="local-8214565720323839625"><a href="CommutativeAlgebra.Polynomial.html#mgcd"><span class="hs-identifier">mgcd</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070890"><a href="#local-6989586621679070890"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070891"><a href="#local-6989586621679070891"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070892"><a href="#local-6989586621679070892"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070893"><a href="#local-6989586621679070893"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mgcd"><span class="hs-identifier hs-var">mgcd</span></a><span> </span><a href="#local-6989586621679070890"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070892"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mgcd"><span class="hs-identifier hs-var">mgcd</span></a><span> </span><a href="#local-6989586621679070891"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070893"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>    </span><a name="local-8214565720323839626"><a href="CommutativeAlgebra.Polynomial.html#mlcm"><span class="hs-identifier">mlcm</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070894"><a href="#local-6989586621679070894"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070895"><a href="#local-6989586621679070895"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070896"><a href="#local-6989586621679070896"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070897"><a href="#local-6989586621679070897"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mlcm"><span class="hs-identifier hs-var">mlcm</span></a><span> </span><a href="#local-6989586621679070894"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070896"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mlcm"><span class="hs-identifier hs-var">mlcm</span></a><span> </span><a href="#local-6989586621679070895"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070897"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>    </span><a name="local-8214565720323839627"><a href="CommutativeAlgebra.Polynomial.html#mcoprime"><span class="hs-identifier">mcoprime</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070898"><a href="#local-6989586621679070898"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679070899"><a href="#local-6989586621679070899"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070900"><a href="#local-6989586621679070900"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679070901"><a href="#local-6989586621679070901"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mcoprime"><span class="hs-identifier hs-var">mcoprime</span></a><span> </span><a href="#local-6989586621679070898"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679070900"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mcoprime"><span class="hs-identifier hs-var">mcoprime</span></a><span> </span><a href="#local-6989586621679070899"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679070901"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-289"></a><span>    </span><a name="local-8214565720323839628"><a href="CommutativeAlgebra.Polynomial.html#mdeg"><span class="hs-identifier">mdeg</span></a></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-var">Elim2</span></a><span> </span><a name="local-6989586621679070902"><a href="#local-6989586621679070902"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679070903"><a href="#local-6989586621679070903"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdeg"><span class="hs-identifier hs-var">mdeg</span></a><span> </span><a href="#local-6989586621679070902"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdeg"><span class="hs-identifier hs-var">mdeg</span></a><span> </span><a href="#local-6989586621679070903"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679070873"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679070873"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><a href="#local-6989586621679070874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679070875"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mon</span><span> </span><a href="#local-6989586621679070875"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679070873"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#Elim2"><span class="hs-identifier hs-type">Elim2</span></a><span> </span><a href="#local-6989586621679070874"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070875"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-292"></a><span>    </span><a name="local-8214565720323838698"><span class="hs-identifier">unit</span></a><span> </span><a name="local-6989586621679070876"><a href="#local-6989586621679070876"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070876"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">munit</span><span>
</span><a name="line-293"></a><span>    </span><a name="local-8214565720323838699"><span class="hs-identifier">mult</span></a><span> </span><a name="local-6989586621679070877"><a href="#local-6989586621679070877"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679070878"><a href="#local-6989586621679070878"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070879"><a href="#local-6989586621679070879"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070878"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mmult</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070879"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070877"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- VARIABLE SUBSTITUTION</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- |Given (Num k, MonomialConstructor m), then Vect k (m v) is the free commutative algebra over v.</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- As such, it is a monad (in the mathematical sense). The following pseudo-code (not legal Haskell)</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- shows how this would work:</span><span>
</span><a name="line-301"></a><span class="hs-comment">--</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- &gt; instance (Num k, Monomial m) =&gt; Monad (\v -&gt; Vect k (m v)) where</span><span>
</span><a name="line-303"></a><span class="hs-comment">-- &gt;     return = var</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- &gt;     (&gt;&gt;=) = bind</span><span>
</span><a name="line-305"></a><span class="hs-comment">--</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- bind corresponds to variable substitution, so @v \`bind\` f@ returns the result of making the substitutions</span><span>
</span><a name="line-307"></a><span class="hs-comment">-- encoded in f into v.</span><span>
</span><a name="line-308"></a><span class="hs-comment">--</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- Note that the type signature is slightly more general than that required by (&gt;&gt;=).</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- For a monad, we would only require:</span><span>
</span><a name="line-311"></a><span class="hs-comment">--</span><span>
</span><a name="line-312"></a><span class="hs-comment">-- &gt; bind :: (MonomialConstructor m, Num k, Ord (m v), Show (m v), Algebra k (m v)) =&gt;</span><span>
</span><a name="line-313"></a><span class="hs-comment">-- &gt;     Vect k (m u) -&gt; (u -&gt; Vect k (m v)) -&gt; Vect k (m v)</span><span>
</span><a name="line-314"></a><span class="hs-comment">--</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- Instead, the given type signature allows us to substitute in elements of any algebra.</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- This is occasionally useful.</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">-- |bind performs variable substitution</span><span>
</span><a name="line-319"></a><span class="hs-identifier">bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="#local-6989586621679069482"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679069483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679069483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679069483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-320"></a><span>    </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069482"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069484"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069484"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679069483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069481"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679069483"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-321"></a><a name="local-6989586621679069496"><a href="#local-6989586621679069496"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">`</span><a name="bind"><a href="CommutativeAlgebra.Polynomial.html#bind"><span class="hs-identifier">bind</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679069497"><a href="#local-6989586621679069497"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">linear</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679069498"><a href="#local-6989586621679069498"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">product</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679069497"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070553"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621679070554"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070553"><a href="#local-6989586621679070553"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070554"><a href="#local-6989586621679070554"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mindices"><span class="hs-identifier hs-var">mindices</span></a><span> </span><a href="#local-6989586621679069498"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679069496"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- V ts `bind` f = sum [c *&gt; product [f x ^ i | (x,i) &lt;- mindices m] | (m, c) &lt;- ts] </span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-comment">-- We can't express the Monad instance directly in Haskell, firstly because of the Ord v constraint (? - not used),</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- secondly because Haskell doesn't support type functions.</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><a name="flipbind"><a href="CommutativeAlgebra.Polynomial.html#flipbind"><span class="hs-identifier">flipbind</span></a></a><span> </span><a name="local-6989586621679070555"><a href="#local-6989586621679070555"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">linear</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679070556"><a href="#local-6989586621679070556"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">product</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679070555"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070557"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621679070558"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070557"><a href="#local-6989586621679070557"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070558"><a href="#local-6989586621679070558"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mindices"><span class="hs-identifier hs-var">mindices</span></a><span> </span><a href="#local-6989586621679070556"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-comment">-- |Evaluate a polynomial at a point.</span><span>
</span><a name="line-330"></a><span class="hs-comment">-- For example @eval (x^2+y^2) [(x,1),(y,2)]@ evaluates x^2+y^2 at the point (x,y)=(1,2).</span><span>
</span><a name="line-331"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="#local-6989586621679069479"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069479"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069480"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679069480"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069479"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069480"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069479"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069480"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679069478"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-333"></a><a name="eval"><a href="CommutativeAlgebra.Polynomial.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679070559"><a href="#local-6989586621679070559"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679070560"><a href="#local-6989586621679070560"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwrap</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679070559"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#bind"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070561"><span class="hs-identifier hs-var">sub</span></a><span>
</span><a name="line-334"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679070561"><a href="#local-6989586621679070561"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679070562"><a href="#local-6989586621679070562"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#var"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679070562"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070560"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-335"></a><span>                  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679070752"><a href="#local-6989586621679070752"><span class="hs-identifier">xval</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070752"><span class="hs-identifier hs-var">xval</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>                  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;eval: no binding given for &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070562"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- |Perform variable substitution on a polynomial.</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- For example @subst (x*z-y^2) [(x,u^2),(y,u*v),(z,v^2)]@ performs the substitution x -&gt; u^2, y -&gt; u*v, z -&gt; v^2.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">subst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069476"><span class="hs-identifier hs-type">u</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679069476"><span class="hs-identifier hs-type">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069477"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069477"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069477"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069476"><span class="hs-identifier hs-type">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069476"><span class="hs-identifier hs-type">u</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069477"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069474"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069475"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069477"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><a name="subst"><a href="CommutativeAlgebra.Polynomial.html#subst"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-6989586621679070786"><a href="#local-6989586621679070786"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679070787"><a href="#local-6989586621679070787"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070786"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#bind"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679070788"><span class="hs-identifier hs-var">sub</span></a><span>
</span><a name="line-343"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679070788"><a href="#local-6989586621679070788"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679070789"><a href="#local-6989586621679070789"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#var"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679070789"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070787"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-344"></a><span>                  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679070790"><a href="#local-6989586621679070790"><span class="hs-identifier">xsub</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070790"><span class="hs-identifier hs-var">xsub</span></a><span>
</span><a name="line-345"></a><span>                  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;eval: no binding given for &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679070789"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- The type could be more general than this, but haven't so far found a use case</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- |List the variables used in a polynomial</span><span>
</span><a name="line-349"></a><span class="hs-identifier">vars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679069408"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679069408"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#MonomialConstructor"><span class="hs-identifier hs-type">MonomialConstructor</span></a><span> </span><a href="#local-6989586621679069409"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069409"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069410"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-350"></a><span>     </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069408"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069409"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069410"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679069408"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069409"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679069410"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-351"></a><a name="vars"><a href="CommutativeAlgebra.Polynomial.html#vars"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679070791"><a href="#local-6989586621679070791"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toSet</span><span> </span><span class="hs-special">[</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#var"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679070804"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070792"><a href="#local-6989586621679070792"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">terms</span><span> </span><a href="#local-6989586621679070791"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679070804"><a href="#local-6989586621679070804"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mindices"><span class="hs-identifier hs-var">mindices</span></a><span> </span><a href="#local-6989586621679070792"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- DIVISION ALGORITHM FOR POLYNOMIALS</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><a name="lt"><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070805"><a href="#local-6989586621679070805"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070806"><a href="#local-6989586621679070806"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070805"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-comment">-- leading term</span><span>
</span><a name="line-357"></a><a name="lm"><a href="CommutativeAlgebra.Polynomial.html#lm"><span class="hs-identifier">lm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span>     </span><span class="hs-comment">-- leading monomial</span><span>
</span><a name="line-358"></a><a name="lc"><a href="CommutativeAlgebra.Polynomial.html#lc"><span class="hs-identifier">lc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span>     </span><span class="hs-comment">-- leading coefficient</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">-- deg :: (Num k, Monomial m, MonomialOrder m) =&gt; Vect k m -&gt; Int</span><span>
</span><a name="line-361"></a><a name="deg"><a href="CommutativeAlgebra.Polynomial.html#deg"><span class="hs-identifier">deg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span>
</span><a name="line-362"></a><span class="hs-identifier">deg</span><span> </span><a name="local-6989586621679070807"><a href="#local-6989586621679070807"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><a href="CommutativeAlgebra.Polynomial.html#mdeg"><span class="hs-identifier hs-var">mdeg</span></a><span> </span><a href="#local-6989586621679070808"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070808"><a href="#local-6989586621679070808"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070809"><a href="#local-6989586621679070809"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">terms</span><span> </span><a href="#local-6989586621679070807"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-363"></a><span class="hs-comment">{-
deg f | isGraded (lm f) = mdeg (lm f)
      | otherwise = maximum $ [mdeg m | (m,c) &lt;- terms f]
-}</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- the true degree of the polynomial, not the degree of the leading term</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- required for sugar strategy when computing Groebner basis</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><a name="toMonic"><a href="CommutativeAlgebra.Polynomial.html#toMonic"><span class="hs-identifier">toMonic</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-371"></a><span class="hs-identifier">toMonic</span><span> </span><a name="local-6989586621679070810"><a href="#local-6989586621679070810"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lc"><span class="hs-identifier hs-var">lc</span></a><span> </span><a href="#local-6989586621679070810"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="#local-6989586621679070810"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">-- tdivmaybe (m1,x1) (m2,x2) = fmap (\m -&gt; (m,x1/x2)) $ mdivmaybe m1 m2</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><a name="tdivides"><a href="CommutativeAlgebra.Polynomial.html#tdivides"><span class="hs-identifier">tdivides</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070811"><a href="#local-6989586621679070811"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070812"><a href="#local-6989586621679070812"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070813"><a href="#local-6989586621679070813"><span class="hs-identifier">m2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070814"><a href="#local-6989586621679070814"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#mdivides"><span class="hs-identifier hs-var">mdivides</span></a><span> </span><a href="#local-6989586621679070811"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679070813"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><a name="tdiv"><a href="CommutativeAlgebra.Polynomial.html#tdiv"><span class="hs-identifier">tdiv</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070815"><a href="#local-6989586621679070815"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070816"><a href="#local-6989586621679070816"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070817"><a href="#local-6989586621679070817"><span class="hs-identifier">m2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070818"><a href="#local-6989586621679070818"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mdiv"><span class="hs-identifier hs-var">mdiv</span></a><span> </span><a href="#local-6989586621679070815"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679070817"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679070816"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679070818"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><a name="tgcd"><a href="CommutativeAlgebra.Polynomial.html#tgcd"><span class="hs-identifier">tgcd</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070819"><a href="#local-6989586621679070819"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070820"><a href="#local-6989586621679070820"><span class="hs-identifier">m2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#mgcd"><span class="hs-identifier hs-var">mgcd</span></a><span> </span><a href="#local-6989586621679070819"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679070820"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- tlcm (m1,_) (m2,_) = (mlcm m1 m2, 1)</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><a name="tmult"><a href="CommutativeAlgebra.Polynomial.html#tmult"><span class="hs-identifier">tmult</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070821"><a href="#local-6989586621679070821"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070822"><a href="#local-6989586621679070822"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070823"><a href="#local-6989586621679070823"><span class="hs-identifier">m'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070824"><a href="#local-6989586621679070824"><span class="hs-identifier">c'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mmult</span><span> </span><a href="#local-6989586621679070821"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679070823"><span class="hs-identifier hs-var">m'</span></a><span class="hs-special">,</span><a href="#local-6989586621679070822"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679070824"><span class="hs-identifier hs-var">c'</span></a><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-operator">*-&gt;</span><span>
</span><a name="line-385"></a><a name="local-6989586621679070825"><a href="#local-6989586621679070825"><span class="hs-identifier">t</span></a></a><span> </span><a name="%2A-%3E"><a href="CommutativeAlgebra.Polynomial.html#%2A-%3E"><span class="hs-operator">*-&gt;</span></a></a><span> </span><span class="hs-identifier hs-var">V</span><span> </span><a name="local-6989586621679070826"><a href="#local-6989586621679070826"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="CommutativeAlgebra.Polynomial.html#tmult"><span class="hs-identifier hs-var">tmult</span></a><span> </span><a href="#local-6989586621679070825"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070826"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-comment">-- preserves term order</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- given f, gs, find as, r such that f = sum (zipWith (*) as gs) + r, with r not divisible by any g</span><span>
</span><a name="line-389"></a><a name="quotRemMP"><a href="CommutativeAlgebra.Polynomial.html#quotRemMP"><span class="hs-identifier">quotRemMP</span></a></a><span> </span><a name="local-6989586621679070827"><a href="#local-6989586621679070827"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679070828"><a href="#local-6989586621679070828"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070830"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679070827"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679070829"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-390"></a><span>    </span><a name="local-6989586621679070829"><a href="#local-6989586621679070829"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679070828"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-391"></a><span>    </span><a name="local-6989586621679070830"><a href="#local-6989586621679070830"><span class="hs-identifier">quotRemMP'</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070833"><a href="#local-6989586621679070833"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070834"><a href="#local-6989586621679070834"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070833"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679070834"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-identifier">quotRemMP'</span><span> </span><a name="local-6989586621679070835"><a href="#local-6989586621679070835"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070836"><a href="#local-6989586621679070836"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070837"><a href="#local-6989586621679070837"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070831"><span class="hs-identifier hs-var">divisionStep</span></a><span> </span><a href="#local-6989586621679070835"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070828"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679070836"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679070837"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>    </span><a name="local-6989586621679070831"><a href="#local-6989586621679070831"><span class="hs-identifier">divisionStep</span></a></a><span> </span><a name="local-6989586621679070838"><a href="#local-6989586621679070838"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679070839"><a href="#local-6989586621679070839"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070840"><a href="#local-6989586621679070840"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070841"><a href="#local-6989586621679070841"><span class="hs-identifier">us'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070842"><a href="#local-6989586621679070842"><span class="hs-identifier">u</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070843"><a href="#local-6989586621679070843"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070844"><a href="#local-6989586621679070844"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-394"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070839"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#tdivides"><span class="hs-identifier hs-var">tdivides</span></a><span class="hs-special">`</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070838"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-395"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679070845"><a href="#local-6989586621679070845"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">[</span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070838"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#tdiv"><span class="hs-identifier hs-var">tdiv</span></a><span class="hs-special">`</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070839"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-396"></a><span>                 </span><a name="local-6989586621679070846"><a href="#local-6989586621679070846"><span class="hs-identifier">h'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070838"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679070845"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679070839"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-397"></a><span>                 </span><a name="local-6989586621679070847"><a href="#local-6989586621679070847"><span class="hs-identifier">u'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070842"><span class="hs-identifier hs-var">u</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679070845"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-398"></a><span>             </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679070830"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679070846"><span class="hs-identifier hs-var">h'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679070841"><span class="hs-identifier hs-var">us'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679070847"><span class="hs-identifier hs-var">u'</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679070843"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679070844"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679070831"><span class="hs-identifier hs-var">divisionStep</span></a><span> </span><a href="#local-6989586621679070838"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070840"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><a href="#local-6989586621679070842"><span class="hs-identifier hs-var">u</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679070841"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><a href="#local-6989586621679070843"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679070844"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-identifier">divisionStep</span><span> </span><a name="local-6989586621679070848"><a href="#local-6989586621679070848"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679070849"><a href="#local-6989586621679070849"><span class="hs-identifier">us'</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679070850"><a href="#local-6989586621679070850"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-401"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070851"><a href="#local-6989586621679070851"><span class="hs-identifier">lth</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070852"><a href="#local-6989586621679070852"><span class="hs-identifier">h'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070832"><span class="hs-identifier hs-var">splitlt</span></a><span> </span><a href="#local-6989586621679070848"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-402"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679070830"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679070852"><span class="hs-identifier hs-var">h'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679070849"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679070850"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679070851"><span class="hs-identifier hs-var">lth</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>    </span><a name="local-6989586621679070832"><a href="#local-6989586621679070832"><span class="hs-identifier">splitlt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070853"><a href="#local-6989586621679070853"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070854"><a href="#local-6989586621679070854"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679070853"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V</span><span> </span><a href="#local-6989586621679070854"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><a name="rewrite"><a href="CommutativeAlgebra.Polynomial.html#rewrite"><span class="hs-identifier">rewrite</span></a></a><span> </span><a name="local-6989586621679070855"><a href="#local-6989586621679070855"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679070856"><a href="#local-6989586621679070856"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070857"><span class="hs-identifier hs-var">rewrite'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070855"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070856"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-407"></a><span>    </span><a name="local-6989586621679070857"><a href="#local-6989586621679070857"><span class="hs-identifier">rewrite'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><a name="local-6989586621679070859"><a href="#local-6989586621679070859"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070859"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-408"></a><span>    </span><span class="hs-identifier">rewrite'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070860"><a href="#local-6989586621679070860"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070861"><a href="#local-6989586621679070861"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070862"><a href="#local-6989586621679070862"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070863"><a href="#local-6989586621679070863"><span class="hs-identifier">hs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-409"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070862"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#tdivides"><span class="hs-identifier hs-var">tdivides</span></a><span class="hs-special">`</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070860"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-comment">-- if lhs of &quot;rewrite rule&quot; h matches</span><span>
</span><a name="line-410"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679070864"><a href="#local-6989586621679070864"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070860"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">[</span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070860"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="CommutativeAlgebra.Polynomial.html#tdiv"><span class="hs-identifier hs-var">tdiv</span></a><span class="hs-special">`</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679070862"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679070862"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-comment">-- apply rewrite rule to eliminate leading term</span><span>
</span><a name="line-411"></a><span>             </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679070857"><span class="hs-identifier hs-var">rewrite'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070864"><span class="hs-identifier hs-var">l'</span></a><span class="hs-special">,</span><a href="#local-6989586621679070861"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070856"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-comment">-- then start again and try to eliminate the new lt.</span><span>
</span><a name="line-412"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679070857"><span class="hs-identifier hs-var">rewrite'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070860"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-6989586621679070861"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070863"><span class="hs-identifier hs-var">hs</span></a><span> </span><span class="hs-comment">-- else try the next potential divisor</span><span>
</span><a name="line-413"></a><span>    </span><span class="hs-identifier">rewrite'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070865"><a href="#local-6989586621679070865"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070866"><a href="#local-6989586621679070866"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- none of the rewrite rules matches lt l</span><span>
</span><a name="line-414"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070867"><a href="#local-6989586621679070867"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><a name="local-6989586621679070868"><a href="#local-6989586621679070868"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070858"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679070865"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-415"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679070857"><span class="hs-identifier hs-var">rewrite'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070868"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679070866"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679070867"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679070856"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-comment">-- so move it into the remainder r, and try to rewrite the other terms</span><span>
</span><a name="line-416"></a><span>    </span><a name="local-6989586621679070858"><a href="#local-6989586621679070858"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679070869"><a href="#local-6989586621679070869"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679070870"><a href="#local-6989586621679070870"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679070869"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V</span><span> </span><a href="#local-6989586621679070870"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-operator">%%</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- |@f %% gs@ is the reduction of a polynomial f with respect to a list of polynomials gs.</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- In the case where the gs are a Groebner basis for an ideal I,</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- then @f %% gs@ is the equivalence class representative of f in R/I,</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- and is zero if and only if f is in I.</span><span>
</span><a name="line-425"></a><span class="hs-special">(</span><span class="hs-operator">%%</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Algebra</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-426"></a><span>     </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vect</span><span> </span><a href="#local-6989586621679068867"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679068868"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-427"></a><a name="local-6989586621679070871"><a href="#local-6989586621679070871"><span class="hs-identifier">f</span></a></a><span> </span><a name="%25%25"><a href="CommutativeAlgebra.Polynomial.html#%25%25"><span class="hs-operator">%%</span></a></a><span> </span><a name="local-6989586621679070872"><a href="#local-6989586621679070872"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CommutativeAlgebra.Polynomial.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-6989586621679070871"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070872"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- f %% gs = r where (_,r) = quotRemMP f gs</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">-- |As a convenience, a partial instance of Fractional is defined for polynomials.</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- The instance is well-defined only for scalars, and gives an error if used on other values.</span><span>
</span><a name="line-433"></a><span class="hs-comment">-- The purpose of this is to allow entry of fractional scalars, in expressions such as @x/2@.</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- On the other hand, an expression such as @2/x@ will return an error.</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-comment">-- instance (Eq k, Fractional k, Monomial m, Ord m, Algebra k m) =&gt; Fractional (Vect k m) where</span><span>
</span><a name="line-437"></a><span class="hs-comment">--     recip (V [(m,c)]) | m == munit = V [(m,1/c)]</span><span>
</span><a name="line-438"></a><span class="hs-comment">--                       | otherwise = error &quot;Polynomial recip: only defined for scalars&quot;</span><span>
</span><a name="line-439"></a><span class="hs-comment">--     fromRational x = V [(munit, fromRational x)]</span><span>
</span><a name="line-440"></a></pre></body></html>